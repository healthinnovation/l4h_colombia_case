[
  {
    "objectID": "case2_colombia.html",
    "href": "case2_colombia.html",
    "title": "Case 02 â€“ Colombia (ðŸ‡¨ðŸ‡´)",
    "section": "",
    "text": "Note\n\n\n\nBetween 2015 and 2023, Colombia experienced recurrent dengue epidemics influenced by climatic anomalies, urban expansion, and unequal access to healthcare.\nHigh-temperature clusters and increased precipitation have been associated with outbreaks in departments such as Antioquia, Valle del Cauca, and Santander, whereas rural areas face delays in case detection due to travel-time barriers.\n\n\n\n\nVisualize how precipitation, urban heat, and rural access interact with dengue incidence in Colombia between 2016 â€“ 2024."
  },
  {
    "objectID": "case2_colombia.html#context",
    "href": "case2_colombia.html#context",
    "title": "Case 02 â€“ Colombia (ðŸ‡¨ðŸ‡´)",
    "section": "",
    "text": "Note\n\n\n\nBetween 2015 and 2023, Colombia experienced recurrent dengue epidemics influenced by climatic anomalies, urban expansion, and unequal access to healthcare.\nHigh-temperature clusters and increased precipitation have been associated with outbreaks in departments such as Antioquia, Valle del Cauca, and Santander, whereas rural areas face delays in case detection due to travel-time barriers.\n\n\n\n\nVisualize how precipitation, urban heat, and rural access interact with dengue incidence in Colombia between 2016 â€“ 2024."
  },
  {
    "objectID": "case2_colombia.html#functions-from-land4health",
    "href": "case2_colombia.html#functions-from-land4health",
    "title": "Case 02 â€“ Colombia (ðŸ‡¨ðŸ‡´)",
    "section": "2 Functions from land4health()",
    "text": "2 Functions from land4health()\n\n\n\n\n\n\n\n\n\nVariable\nFunction\nDescription\n\n\n\n\nDengue cases\nl4h_dengue_cases()\nExtracts harmonized weekly dengue case data from the OpenDengue Project for a specified date range and country, returning a tidy tibble suitable for spatial or temporal analyses.\n\n\nSurface temperature\nl4h_surface_temp()\nExtracts daytime or nighttime Land Surface Temperature (LST) for a user-defined region and time range using the MODIS MOD11A1.061 product. The function supports summarizing the temperature data over each date using a selected statistic (e.g., mean or median)\n\n\nRural access\nl4h_rural_access_index()\nCalculates the Rural Access Index (RAI) â€” the proportion of the rural population living within 2 km of an all-season road â€” based on global GEE datasets aligned with SDG 9.1.1.\n\n\nPrecipitation\nl4h_terra_climate()\nExtracts monthly TerraClimate indicators (e.g., precipitation, ) aggregated over a user-defined region using Earth Engine, returning climate-ready covariates."
  },
  {
    "objectID": "case2_colombia.html#workflow",
    "href": "case2_colombia.html#workflow",
    "title": "Case 02 â€“ Colombia (ðŸ‡¨ðŸ‡´)",
    "section": "3 Workflow",
    "text": "3 Workflow\n\n3.1 Libraries\nWe need to verify and load all the necessary packages required for this case. It ensures that dependencies for spatial, environmental, and epidemiological analyses are properly installed and available. If any package is missing, install it manually with: install.packages()\n\nlibrary(land4health)\nlibrary(geodata)\nlibrary(ggplot2)\nlibrary(tidyverse)\nlibrary(sf)\nlibrary(terra)\nlibrary(tidyterra)\nlibrary(malariaAtlas)\nlibrary(RColorBrewer)\nlibrary(lubridate)\nlibrary(leaflet.extras2)\nlibrary(purrr)\nlibrary(lubridate)\nlibrary(patchwork)\nlibrary(mapview)\nlibrary(rmapshaper)\nlibrary(viridis)\nlibrary(stringi)\nlibrary(cowplot)\n# ee_Authenticate()   # Run once if not authenticated\nee_Initialize()\n\nâ”€â”€ rgee 1.1.7 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ earthengine-api 0.1.317 â”€â”€ \n âœ” user: not_defined \n âœ” Initializing Google Earth Engine:\n âœ” Initializing Google Earth Engine:  DONE!\n\n âœ” Earth Engine account: users/yomali_ferreyra \n\n âœ” Python Path: C:/Users/yomal/AppData/Local/Programs/Python/Python39/python.exe \nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ \n\n\n\n\n3.2 Spatial data preparation\nWe first load and define the administrative boundaries that will serve as the spatial reference for all analyses. The shapefiles are retrieved from the GADM dataset via the geodata package.\n\ncolombia_sf &lt;- geodata::gadm(country = \"CO\", level = 1, path = tempdir()) |&gt; \n  st_as_sf()\n\ncolombia_sf &lt;- rmapshaper::ms_simplify(colombia_sf, keep = 0.01)  \n\nrmapshaper::ms_simplify() function simplifies the spatial geometry by removing redundant vertices while maintaining the overall shape and topology of the polygons.\n\n\n3.3 Dengue cases\nWe retrieved harmonized weekly dengue case data from the OpenDengue Project, an open-access repository compiling surveillance information reported by national ministries of health across Latin America. Using the l4h_dengue_cases() function from the Land4Health library, we extracted all available records for Colombia between January and December 2021.\n\ndengue_spat &lt;- l4h_dengue_cases(\n    from = \"2021-01-01\",\n    to = \"2021-12-31\",\n    data_type = \"temporal\",\n    country = \"Colombia\",\n    cache = TRUE,\n    quiet = TRUE,\n  )\n\n\n\nCode\ndengue_week &lt;- dengue_spat %&gt;%\n  filter(!is.na(state)) %&gt;%                              \n  mutate(week = lubridate::week((as.Date(date_start)))) %&gt;%        \n  group_by(week) %&gt;%\n  summarise(total_cases = sum(cases, na.rm = TRUE)) %&gt;%  #\n  arrange(week)\n\nggplot(dengue_week, aes(x = week, y = total_cases)) +\n  geom_col(fill = \"#d73027\", color = \"white\", width = 0.8) + \n  geom_line(aes(y = total_cases), color = \"#67000d\", linewidth = 0.6, alpha = 0.8) +  \n  geom_point(color = \"#67000d\", size = 1.5, alpha = 0.8) +\n  scale_x_continuous(breaks = seq(1, 52, by = 1)) +  #\n  labs(\n    x = \"Epidemiological week\",\n    y = \"Dengue cases (2021)\"\n  ) +\n  theme_classic(base_size = 8) +\n  theme(\n    plot.title = element_text(face = \"bold\", size = 15, hjust = 0.5),\n    axis.text = element_text(color = \"black\"),\n    axis.line = element_line(color = \"gray40\"),\n    panel.grid.major.y = element_line(color = \"gray90\", size = 0.3),\n    panel.grid.minor = element_blank(),\n    axis.ticks = element_line(color = \"gray60\"),\n    plot.background = element_rect(fill = \"white\", color = NA)\n  )\n\n\n\n\n\n\n\n\n\n\n\n3.4 Land Surface Temperature (LST)\nWe extracted Land Surface Temperature (LST) data to characterize spatiotemporal variations in surface temperature across Colombia, using the l4h_surface_temp() function. The resulting dataset provides daily temperature estimates (in Â°C) derived from the MODIS MOD11A1.061 product, enabling the analysis of thermal patterns and their relationship with climatic drivers such as precipitation.\n\n#Temperature\nlst_day &lt;- l4h_surface_temp(\n  from = \"2021-01-01\",\n  to   = \"2021-12-31\",\n  region = colombia_sf,\n  band = \"day\",\n  stat = \"mean\")\n\n\n\n3.5 Precipitation\nWe extracted daily precipitation (pr) data from the TerraClimate dataset to characterize spatial and temporal rainfall variability across Colombia during 2021. Using the l4h_terra_climate()\n\n#Precipitation\nout_pr &lt;- l4h_terra_climate(\n  from = \"2021-01-01\",\n  to   = \"2021-12-31\",\n  band = \"pr\",\n  region = colombia_sf,\n  stat = \"mean\",\n  scale = 5000\n)\n\nThis code extracts and summarizes Land Surface Temperature (LST) and precipitation data by administrative region (NAME_1) for a specific month, defined by the variable selected_month (in this case, March). First, the lst_day dataset is processed by converting the date variable into a monthly index using month(), grouping observations by region and month, and calculating the mean surface temperature for each group. The st_union() function merges geometries that belong to the same administrative region, and finally the dataset is filtered to keep only the selected month. The same procedure is then applied to the precipitation dataset (out_pr), where the mean monthly precipitation is computed for each region. As a result, two spatial datasets are obtainedâ€”one for temperature and another for precipitationâ€”aggregated at the regional level and aligned temporally to allow direct comparison or visualization with mapping tools such as mapview() or sync().\n\n#Precipitation\n\nselected_month &lt;- 3 \n\nlst_monthly &lt;- lst_day %&gt;%\n  mutate(month = month(as.Date(date))) %&gt;%\n  group_by(NAME_1, month) %&gt;%\n  summarise(mean_temp = mean(value, na.rm = TRUE),\n            geometry = st_union(geometry),\n            .groups = \"drop\") %&gt;% filter(month == selected_month)\n\npr_monthly &lt;- out_pr %&gt;%\n  mutate(month = month(as.Date(date))) %&gt;%\n  group_by(NAME_1, month) %&gt;%\n  summarise(mean_pr = mean(value, na.rm = TRUE),\n            geometry = st_union(geometry),\n            .groups = \"drop\") %&gt;% filter(month == selected_month)\n\nMap shows a clear thermal gradient across Colombia, with higher temperatures concentrated in the northern and northeastern regionsâ€”particularly along the Caribbean coast and parts of the Magdalena River valleyâ€”while cooler conditions dominate the southern Amazonian departments (e.g., CaquetÃ¡, Putumayo, Amazonas). This spatial pattern aligns with expected latitudinal and altitudinal influences: coastal lowlands and arid valleys exhibit greater solar exposure, whereas forested and high-altitude zones maintain lower surface temperatures.\n\n\nCode\nmap_temp &lt;- mapview(\n  lst_monthly,\n  zcol = \"mean_temp\",\n  layer.name = paste0(\"LST â€“ (Â°C)\"),\n  col.regions = colorRampPalette(c(\"#2c7bb6\", \"#abd9e9\", \"#ffffbf\", \"#fdae61\", \"#d7191c\"))(5),\n  at = pretty(lst_monthly$mean_temp, n = 5),  \n  alpha = 0.9\n)\n\nmap_pr &lt;- mapview(\n  pr_monthly,\n  zcol = \"mean_pr\",\n  layer.name = paste0(\"Precipitation (mm)\"),\n  col.regions = colorRampPalette(c(\"#8c510a\", \"#d8b365\", \"#f6e8c3\", \"#5ab4ac\", \"#01665e\"))(5),\n  alpha = 0.9\n)\n\nmap_pr | map_temp\n\n\n\n\n\n\n\nIn contrast, the southern and southwestern Amazonian regions register the highest rainfall, while northern and central areasâ€”especially along the Caribbean coast and inter-Andean valleysâ€”show drier conditions. This reflects Colombiaâ€™s climatic duality, where equatorial convection and Amazonian moisture drive rainfall in the south, while northern lowlands experience more seasonal or arid regimes. Together, these maps highlight a negative correlation between temperature and precipitation: warmer areas tend to be drier, and wetter regions tend to be cooler, a pattern consistent with Colombiaâ€™s topography and climatic zonation.\n\n\n3.6 How dengue cases vary in different conditions?\n\n\nCode\ndengue_month &lt;- dengue_spat %&gt;%\n  filter(!is.na(state)) %&gt;%\n  mutate(\n    month_num  = month(as.Date(date_start)),\n    month_name = month(as.Date(date_start), label = TRUE)\n  ) %&gt;%\n  group_by(state, month_num, month_name) %&gt;%\n  summarise(total_cases = sum(cases, na.rm = TRUE), .groups = \"drop\") %&gt;%\n  arrange(state, month_num,month_name)%&gt;%\n  mutate(\n    state_clean = stri_trans_general(state, \"Latin-ASCII\") |&gt; toupper()\n  )\n\npr_monthly &lt;- out_pr %&gt;%\n  mutate(month = month(as.Date(date))) %&gt;%\n  group_by(NAME_1, month) %&gt;%\n  summarise(mean_pr = mean(value, na.rm = TRUE),\n            geometry = st_union(geometry),\n            .groups = \"drop\")%&gt;%\n  mutate(\n    NAME_1_clean = stri_trans_general(NAME_1, \"Latin-ASCII\") |&gt; toupper()  \n  )\n\ndengue_pr_joined &lt;- pr_monthly %&gt;%\n  left_join(\n    dengue_month,\n    by = c(\"NAME_1_clean\" = \"state_clean\", \"month\" = \"month_num\")\n  )\n\nmonths_available &lt;- unique(dengue_pr_joined$month_name)\n\nbiv_pal &lt;- c(\n  \"1-1\" = \"#e8e8e8\", \"2-1\" = \"#b5c0da\", \"3-1\" = \"#6c83b5\",\n  \"1-2\" = \"#b8d6be\", \"2-2\" = \"#90b2b3\", \"3-2\" = \"#567994\",\n  \"1-3\" = \"#73ae80\", \"2-3\" = \"#5a9178\", \"3-3\" = \"#2a5a5b\"\n)\n\nmaps &lt;- list()\n\nfor (m in months_available) {\n  \n  df &lt;- dengue_pr_joined %&gt;%\n    filter(month_name == m) %&gt;%\n    filter(!is.na(mean_pr), !is.na(total_cases))\n  \n  if (nrow(df) &gt; 5) {\n    q_precip_vals &lt;- quantile(df$mean_pr, probs = seq(0, 1, length.out = 4), na.rm = TRUE)\n    q_dengue_vals &lt;- quantile(df$total_cases, probs = seq(0, 1, length.out = 4), na.rm = TRUE)\n    q_precip_vals &lt;- sort(na.omit(unique(q_precip_vals)))\n    q_dengue_vals &lt;- sort(na.omit(unique(q_dengue_vals)))\n    if (length(q_precip_vals) &lt; 2 || length(q_dengue_vals) &lt; 2) next\n    \n    df &lt;- df %&gt;%\n      mutate(\n        q_precip = findInterval(mean_pr, q_precip_vals, all.inside = TRUE),\n        q_dengue = findInterval(total_cases, q_dengue_vals, all.inside = TRUE),\n        biv_code = paste0(q_precip, \"-\", q_dengue)\n      )\n    \n    p &lt;- ggplot(df) +\n      geom_sf(aes(fill = biv_code), color = \"white\", size = 0.2) +\n      scale_fill_manual(values = biv_pal, na.value = \"gray90\") +\n      theme_void() +\n      labs(title = paste0(m)) +\n      theme(\n        plot.title = element_text(hjust = 0.5, size = 11, face = \"bold\"),\n        legend.position = \"none\"\n      )\n    \n    maps[[as.character(m)]] &lt;- p\n  }\n}\n\nmap_faceted &lt;- wrap_plots(maps, ncol = 4, nrow = 3) +\n  plot_annotation(\n    theme = theme(plot.title = element_text(size = 14, face = \"bold\"))\n  )\n\nn_breaks &lt;- 3\nvar1_label &lt;- \"Precipitation\"\nvar2_label &lt;- \"Dengue cases\"\n\nlegend_df &lt;- expand.grid(v1_class = 1:n_breaks, v2_class = 1:n_breaks) %&gt;%\n  mutate(fill = as.vector(t(biv_pal)))\n\nlegend_plot &lt;- ggplot(legend_df, aes(x = v1_class, y = v2_class, fill = fill)) +\n  geom_tile(color = \"white\") +\n  scale_fill_identity() +\n  coord_equal() +\n  theme_void() +\n  theme(plot.margin = margin(10, 10, 10, 10)) +\n  annotate(\"segment\", x = 1, xend = n_breaks + 0.5, y = 0.3, yend = 0.3,\n           arrow = arrow(length = unit(0.25, \"cm\")), color = \"black\", size = 0.6) +\n  annotate(\"segment\", x = 0.3, xend = 0.3, y = 1, yend = n_breaks + 0.5,\n           arrow = arrow(length = unit(0.25, \"cm\")), color = \"black\", size = 0.6) +\n  annotate(\"text\", x = (n_breaks + 1) / 2, y = -0.2,\n           label = paste0(var1_label),\n           size = 2, fontface = \"bold\") +\n  annotate(\"text\", x = 0, y = (n_breaks + 1) / 2,\n           label = paste0(var2_label),\n           size = 2, fontface = \"bold\", angle = 90)\n\nfinal_plot &lt;- ggdraw() +\n  draw_plot(map_faceted, 0, 0, 1, 1) +                       \n  draw_plot(legend_plot, 0.73, 0.05, 0.27, 0.27)          \n\nfinal_plot"
  }
]